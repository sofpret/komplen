<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Laporan Trouble Rz.Speed</title>
</head>
<body>
<h2>Laporan Trouble Rz.Speed</h2>
<input type="text" id="nama" placeholder="Nama" required><br>
<input type="text" id="alamat" placeholder="Alamat" required><br>
<textarea id="keluhan" placeholder="Keluhan" required></textarea><br>
<input type="file" id="foto" accept="image/*"><br>
<button onclick="kirim()">Kirim</button>

<div id="status"></div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwK_PS-SXT0dscwMx3CsKYAgnY9B3o0GEtw1EQAtX6n7cqj07y4Tw8DdUjOtqwkQsZD/exec"; // ganti URL GAS

function toBase64(file){
  return new Promise((resolve, reject)=>{
    const reader = new FileReader();
    reader.onload = ()=>resolve(reader.result);
    reader.onerror = error=>reject(error);
    reader.readAsDataURL(file);
  });
}

async function kirim(){
  const nama = document.getElementById("nama").value.trim();
  const alamat = document.getElementById("alamat").value.trim();
  const keluhan = document.getElementById("keluhan").value.trim();
  const fotoInput = document.getElementById("foto");
  if(!nama||!alamat||!keluhan){ alert("Isi semua field!"); return; }

  let fotoBase64 = "";
  if(fotoInput.files.length>0){
    fotoBase64 = await toBase64(fotoInput.files[0]);
  }

  const payload = {nama, alamat, keluhan, foto: fotoBase64};

  fetch(WEB_APP_URL,{
    method:"POST",
    body: JSON.stringify(payload)
  }).then(r=>r.json()).then(res=>{
    if(res.status=="success"){
      document.getElementById("status").innerHTML="✅ Laporan terkirim!";
      document.getElementById("nama").value="";
      document.getElementById("alamat").value="";
      document.getElementById("keluhan").value="";
      document.getElementById("foto").value="";
    } else {
      document.getElementById("status").innerHTML="❌ Error: "+res.message;
    }
  }).catch(err=>{
    document.getElementById("status").innerHTML="❌ Error: "+err;
  });
}
</script>
</body>
</html>
